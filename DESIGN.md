# Socrates アプリ 設計要約

## 概要

**Socrates**は、LLM（大規模言語モデル）を使用した一対一のディベートバトルアプリです。ユーザーはランダムまたは選択されたトピックに基づき、議論を行い、その議論を AI が評価してより優れた意見を持っている方を判定します。議論の楽しさと深い語り合いを世界中に広めることを目的とします。

## 技術スタック

- **フロントエンド**: Next.js, TypeScript, TailwindCSS
- **バックエンド**: Serverless Functions (Firebase Functions)
- **データベース & ストレージ**: Firestore, Firebase Storage
- **認証**: Firebase Authentication
- **インフラストラクチャ**: Firebase Hosting, Cloud Functions

## Firestore セキュリティルール

- **認証済みユーザー**のみが自分の情報に対して CRUD 操作が可能です。
- **プロフィール**は公開読み取り可能で、所有者のみが更新可能です。
- **セッション（ディベートとチャット）**: 参加者のみがアクセス可能です。チャットは、セッション作成者が公開または非公開を選択できます。

## チャットの公開性設定

- カスタムマッチやルームマッチの際、チャットを公開または非公開に設定できるオプションを提供します。
- **公開設定**: 参加者以外のユーザーもチャット内容を閲覧できます。
- **非公開設定**: チャット内容は参加者のみが閲覧可能です。

## API 設計（サーバーレス）

### マッチング関連

- `/api/match/random`: ランダムマッチングを行います。
  - 実装: Cloud Functions を利用してランダムマッチングのロジックを実装します。
- `/api/match/custom`: カスタムマッチングを行います。チャットの公開/非公開設定含む。
  - 実装: Cloud Functions を利用してカスタムマッチングのロジックを実装します。

### ディベート関連

- `/api/debate/start`: 新しいディベートセッションを開始します。
  - 実装: Cloud Functions を利用してディベートセッションの開始ロジックを実装します。
- `/api/debate/submit_response`: ディベート中の発言を提出します。
  - 実装: Cloud Functions を利用してディベート中の発言提出ロジックを実装します。
- `/api/debate/judge`: ディベートの終了時に、勝者を判定します。
  - 実装: Cloud Functions を利用してディベートの採点と勝者判定ロジックを実装します。

## フロントエンドの主要ページ

- **ホームページ**: アプリの概要と主な機能紹介。
- **登録/ログインページ**: ユーザー登録とログイン。Firebase Authentication を利用。
- **マッチメイキングページ**: マッチタイプ選択。Firebase Functions を通じて行います。
- **ディベート/チャットページ**: ディベート実施、Firebase Firestore でのリアルタイムチャット機能。
- **プロファイルページ**: ユーザー情報、ディベート履歴。Firestore を利用して表示します。
- **フィードバックページ**: ユーザーフィードバック送信。Cloud Functions 経由で処理されます。
