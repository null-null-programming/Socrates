(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[417],{7532:function(e,r,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/create",function(){return s(72)}])},221:function(e,r,s){"use strict";s.d(r,{Z:function(){return x}});var t=s(5893),n=s(8604),l=s(6718),i=s(8464);let c=()=>{let e=new l.hJ;return(0,l.rh)(i.I8,e)},o=()=>(0,l.w7)(i.I8);var a=s(1664),d=s.n(a),u=s(7294),x=()=>{let[e,r]=(0,u.useState)(!1),{user:s}=(0,n.a)(),[l,i]=(0,u.useState)(!1),a=()=>{i(!0),c().catch(e=>{console.error(null==e?void 0:e.code)}).finally(()=>{i(!1)})};return(0,t.jsxs)("div",{className:"apply-font",children:[(0,t.jsx)("div",{className:"page-background"}),(0,t.jsxs)("nav",{className:"px-5 py-0text-[#F0E3E3]",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)(d(),{href:"/",scroll:!1,children:(0,t.jsx)("b",{className:"font-semibold text-6xl cursor-pointer",children:"Socrates"})}),(0,t.jsx)("button",{onClick:()=>r(!e),className:"text-3xl md:hidden focus:outline-none",children:"☰"}),(0,t.jsxs)("div",{className:"hidden md:flex text-4xl",children:[(0,t.jsx)(d(),{href:"/",scroll:!1,children:(0,t.jsx)("b",{className:"mr-4 cursor-pointer",children:"Home"})}),s&&(0,t.jsx)(d(),{href:"/create",scroll:!1,children:(0,t.jsx)("b",{className:"mr-4 cursor-pointer",children:"Create"})}),s&&(0,t.jsx)(d(),{href:"/room",scroll:!1,children:(0,t.jsx)("b",{className:"mr-4 cursor-pointer",children:"Room"})}),s&&(0,t.jsx)(d(),{href:"/ranking",scroll:!1,children:(0,t.jsx)("b",{className:"mr-4 cursor-pointer",children:"Ranking"})}),s&&(0,t.jsx)(d(),{href:"/profile",scroll:!1,children:(0,t.jsx)("b",{className:"mr-4 cursor-pointer",children:"Profile"})}),(0,t.jsx)("div",{onClick:()=>r(!1),className:"cursor-pointer pl-4",children:null===s&&!l&&(0,t.jsx)("button",{onClick:a,children:(0,t.jsx)("b",{children:"Login"})})}),(0,t.jsx)("div",{onClick:()=>r(!1),className:"cursor-pointer ",children:s&&(0,t.jsx)("button",{onClick:o,children:(0,t.jsx)("b",{children:"Logout"})})})]})]}),(0,t.jsxs)("div",{className:"fixed inset-0 z-20 p-10 text-lg md:hidden ".concat(e?"opacity-100":"opacity-0 pointer-events-none"," transition-opacity duration-500 ease-in-out transform ").concat(e?"translate-y-0":"translate3d(0, -10px, 0)"),style:{backgroundColor:"rgba(25, 24, 37, 0.95)",willChange:"opacity, transform"},children:[(0,t.jsx)("button",{onClick:()=>r(!1),className:"absolute top-5 right-5 text-8xl cursor-pointer focus:outline-none transition-transform duration-300 ease-out",style:{transform:e?"rotate(0)":"rotate(90deg)",willChange:"transform"},children:"\xd7"}),(0,t.jsxs)("ul",{className:"space-y-8 ".concat(e?"translate-y-0":"-translate-y-10"," transition-transform duration-500 ease-in-out"),children:[(0,t.jsx)("li",{children:(0,t.jsx)(d(),{href:"/",scroll:!1,children:(0,t.jsx)("b",{onClick:()=>r(!1),className:"cursor-pointer text-7xl",children:"Home"})})}),s&&(0,t.jsx)("li",{children:(0,t.jsx)(d(),{href:"/create",scroll:!1,children:(0,t.jsx)("b",{onClick:()=>r(!1),className:"cursor-pointer text-7xl",children:"Create"})})}),s&&(0,t.jsx)("li",{children:(0,t.jsx)(d(),{href:"/room",scroll:!1,children:(0,t.jsx)("b",{onClick:()=>r(!1),className:"cursor-pointer text-7xl",children:"Room"})})}),s&&(0,t.jsx)("li",{children:(0,t.jsx)(d(),{href:"/ranking",scroll:!1,children:(0,t.jsx)("b",{onClick:()=>r(!1),className:"cursor-pointer text-7xl",children:"Ranking"})})}),s&&(0,t.jsx)("li",{children:(0,t.jsx)(d(),{href:"/profile",scroll:!1,children:(0,t.jsx)("b",{onClick:()=>r(!1),className:"cursor-pointer text-7xl",children:"Profile"})})}),(0,t.jsx)("li",{children:(0,t.jsx)("div",{onClick:()=>r(!1),className:"cursor-pointer text-7xl",children:null===s&&!l&&(0,t.jsx)("button",{onClick:a,children:(0,t.jsx)("b",{children:"Login"})})})}),(0,t.jsx)("li",{children:(0,t.jsx)("div",{onClick:()=>r(!1),className:"cursor-pointer text-7xl",children:s&&(0,t.jsx)("button",{onClick:o,children:(0,t.jsx)("b",{children:"Logout"})})})})]})]})]})]})}},2738:function(e,r,s){"use strict";var t=s(9828),n=s(8464);let l=async e=>{if(!e)return null;let r=(0,t.JU)(n.db,"users",e);try{let e=await (0,t.QT)(r);if(e.exists())return{user_name:e.data().user_name||"Anonymous",imgUrl:e.data().img_url||"https://firebasestorage.googleapis.com/v0/b/socrates-413218.appspot.com/o/util%2Fanonymous.png?alt=media&token=b433ffba-46b8-47cb-8699-6c2780814c34",rate:e.data().rate||1500};return console.log("No such document!"),null}catch(e){return console.error("Error fetching user data:",e),null}};r.Z=l},72:function(e,r,s){"use strict";s.r(r);var t=s(5893),n=s(8604),l=s(8464),i=s(9828),c=s(7004),o=s(1163),a=s(7294),d=s(221),u=s(2738);r.default=()=>{let[e,r]=(0,a.useState)("100px"),[s,x]=(0,a.useState)(!1),[h,m]=(0,a.useState)(""),j=(0,o.useRouter)(),{user:f,token:p}=(0,n.a)(),b=null==f?void 0:f.id;(0,a.useEffect)(()=>{{let e=window.innerHeight/7;r("".concat(e,"px"))}},[]);let N=async e=>{if(!e){alert("ログインしてください。");return}try{let r=(0,i.hJ)(l.db,"waiting_list"),s=(0,i.IO)(r,(0,i.ar)("userId","==",e)),t=await (0,i.PL)(s);if(!t.empty){if(!confirm("過去に作ったルームが存在します。消去しますか？"))return console.log("処理を中断しました。"),!1;{let e=(0,i.qs)(l.db);t.forEach(r=>{e.delete(r.ref)}),await e.commit(),console.log("過去の待機リストエントリが削除されました。")}}return!0}catch(e){return console.error("ディベートの開始または待機リストの処理に失敗しました:",e),alert("エラーが発生しました。"),!1}},g=async()=>{x(!0);try{if(!f){alert("ログインしてください。"),x(!1);return}if(!N(f.id)){x(!1);return}let e=await (0,u.Z)(b),r=(null==e?void 0:e.user_name)||"Anonymous",s=(0,c.V1)(l.wk,"enqueueUser"),t=await s({topic:h,userName:r});if("waiting"===t.data.status){x(!0);let e=(0,i.cf)((0,i.JU)(l.db,"users",f.id),r=>{let s=r.data();(null==s?void 0:s.sessionId)&&(e(),j.push("/session/".concat(s.sessionId)))})}else"matched"===t.data.status&&(x(!1),j.push("/session/".concat(t.data.session_id)));console.log(t)}catch(e){console.error("ディベートの開始に失敗しました:",e),alert("ディベートを開始できませんでした。"),x(!1)}};return(0,t.jsxs)("div",{className:"japanese-font",children:[(0,t.jsxs)("div",{className:"mx-auto max-w-6xl pt-8 px-4 min-h-screen text-outline",children:[(0,t.jsx)(d.Z,{}),(0,t.jsxs)("div",{className:"text-center p-8",children:[(0,t.jsx)("h2",{className:"text-3xl font-bold mt-8 mb-4",children:"ルーム作成"}),(0,t.jsxs)("ul",{className:"list-disc list-inside space-y-2 mb-6 mx-auto text-xl",style:{maxWidth:"800px"},children:[(0,t.jsx)("li",{children:"討論するお題を入力してください。"}),(0,t.jsx)("li",{children:"お題の文字数は300文字までです。"}),(0,t.jsx)("li",{children:"お題は賛成か反対かのどちらかで分けられる問いにしてください。"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{children:(0,t.jsx)("textarea",{value:h,maxLength:300,style:{height:e},onChange:e=>m(e.target.value),placeholder:"死刑制度に賛成か、反対か？",className:"border bg-[#191825] border-[#F0E3E3] p-4 text-white w-full"})}),(0,t.jsx)("div",{className:"p-5",children:(0,t.jsx)("button",{className:"apply-font text-4xl border border-[#F0E3E3] bg-[#191825] text-[#F0E3E3] font-bold py-2 px-4 rounded transition-colors",onClick:g,disabled:s||!h.trim(),children:"Start Debate"})})]})]})]}),s&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-white"})})]})}}},function(e){e.O(0,[664,888,774,179],function(){return e(e.s=7532)}),_N_E=e.O()}]);